#####################################
# modsecurity.conf minimal pour Docker
#####################################

# 1️⃣ Active ModSecurity
SecRuleEngine On

# 2️⃣ Audit log (toutes les requêtes bloquées seront loggées)
SecAuditEngine On
SecAuditLog /tmp/modsec_audit.log
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial

# 3️⃣ Debug log pour voir toutes les règles évaluées
SecDebugLog /tmp/modsec_debug.log
SecDebugLogLevel 9

# 4️⃣ Règle custom : bloque toute URI contenant "test"
SecRule REQUEST_URI "@contains test" \
    "id:1001,phase:1,deny,status:403,msg:'Blocked request containing test',log,ctl:auditEngine=On"


